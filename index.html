<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Share A Note – Send & Receive Anonymous Messages Instantly</title>
  <meta name="description" content="Share A Note is a secure, anonymous platform to send and receive notes instantly with no login or tracking. A safe space for connection, clarity, and compassion." />
  <meta name="robots" content="index, follow" />
  <meta name="keywords" content="anonymous notes, share a note, no login messages, private messaging, anonymous message board, safe messaging, secure notes" />
  <meta name="author" content="Share A Note Team" />
  <meta name="theme-color" content="#0f172a" />
  <meta name="color-scheme" content="dark light" />
  <meta name="google-site-verification" content="google4179691d1eb22dd9" />
  <link rel="canonical" href="https://shareanote.com/" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap"></noscript>
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" as="script">
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
  <button id="sendBtn">Send Note</button>
  <div id="sendCounter"></div>
  <button id="receiveBtn">Receive Note</button>
  <div id="receiveCounter"></div>
  <textarea id="noteInput"></textarea>
  <div id="popup"><h3 id="popupTitle"></h3><p id="popupContent"></p><button id="closePopup">Close</button></div>
  <script>
    const BACKEND_URL = 'https://shareanote-backend.onrender.com';
    const sendBtn = document.getElementById('sendBtn');
    const receiveBtn = document.getElementById('receiveBtn');
    const textarea = document.getElementById('noteInput');
    const popup = document.getElementById('popup');
    const popupTitle = document.getElementById('popupTitle');
    const popupContent = document.getElementById('popupContent');
    const closePopup = document.getElementById('closePopup');
    const sendCounter = document.getElementById('sendCounter');
    const receiveCounter = document.getElementById('receiveCounter');

    const MAX_CLICKS = 3;
    const ONE_HOUR = 60 * 60 * 1000;

    function getRateData(type) {
      const data = JSON.parse(localStorage.getItem(`${type}Rate`) || '{}');
      if (!data.timestamp || Date.now() - data.timestamp > ONE_HOUR) {
        return { count: 0, timestamp: Date.now() };
      }
      return data;
    }

    function setRateData(type, count) {
      const data = { count, timestamp: Date.now() };
      localStorage.setItem(`${type}Rate`, JSON.stringify(data));
    }

    let sendRate = getRateData('send');
    let receiveRate = getRateData('receive');

    function updateCounters() {
      sendCounter.textContent = `You have ${Math.max(0, MAX_CLICKS - sendRate.count)} sends left`;
      receiveCounter.textContent = `You have ${Math.max(0, MAX_CLICKS - receiveRate.count)} receives left`;
    }

    function showPopup(title, message) {
      popupTitle.textContent = title;
      popupContent.textContent = message;
      popup.style.display = 'block';
      closePopup.focus();
    }

    function celebrate() {
      confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    }

    function showDoneAnimation() {
      const doneMsg = document.createElement('div');
      doneMsg.textContent = 'You’re all done!';
      doneMsg.style.position = 'fixed';
      doneMsg.style.top = '50%';
      doneMsg.style.left = '50%';
      doneMsg.style.transform = 'translate(-50%, -50%) scale(0.5)';
      doneMsg.style.background = '#0f172a';
      doneMsg.style.padding = '20px 30px';
      doneMsg.style.border = '2px solid #3b82f6';
      doneMsg.style.borderRadius = '12px';
      doneMsg.style.color = '#e0f2fe';
      doneMsg.style.fontSize = '1.5rem';
      doneMsg.style.zIndex = 20;
      doneMsg.style.boxShadow = '0 0 20px #3b82f6';
      doneMsg.style.opacity = '0';
      doneMsg.style.transition = 'transform 0.5s ease, opacity 0.5s ease';

      document.body.appendChild(doneMsg);
      setTimeout(() => {
        doneMsg.style.opacity = '1';
        doneMsg.style.transform = 'translate(-50%, -50%) scale(1)';
      }, 50);
      setTimeout(() => {
        doneMsg.style.opacity = '0';
        doneMsg.style.transform = 'translate(-50%, -50%) scale(0.5)';
      }, 3000);
      setTimeout(() => {
        document.body.removeChild(doneMsg);
      }, 3500);
    }

    sendBtn.addEventListener('click', () => {
      if (sendRate.count >= MAX_CLICKS) {
        showPopup("Rate Limit Reached", "You've reached the limit for sending notes.");
        showDoneAnimation();
        return;
      }

      const note = textarea.value.trim();
      if (!note) return showPopup("Error", "Please enter a note.");

      fetch(`${BACKEND_URL}/notes`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: note })
      })
        .then(res => res.json())
        .then(data => {
          if (data.status === 'success') {
            textarea.value = '';
            showPopup("Note Sent", "Note sent successfully!");
            celebrate();
            sendRate.count++;
            setRateData('send', sendRate.count);
            updateCounters();
          } else {
            showPopup("Note Rejected", data.status || "Error sending note.");
          }
        })
        .catch(err => {
          showPopup("Error", "Failed to send note.");
          console.error(err);
        });
    });

    receiveBtn.addEventListener('click', () => {
      if (receiveRate.count >= MAX_CLICKS) {
        showPopup("Rate Limit Reached", "You've reached the limit for receiving notes.");
        showDoneAnimation();
        return;
      }

      fetch(`${BACKEND_URL}/notes/random`)
        .then(res => res.json())
        .then(data => {
          showPopup("Note Received", data.message || "No note found.");
          celebrate();
          receiveRate.count++;
          setRateData('receive', receiveRate.count);
          updateCounters();
        })
        .catch(err => {
          showPopup("Error", "Failed to retrieve note.");
          console.error(err);
        });
    });

    closePopup.addEventListener('click', () => {
      popup.style.display = 'none';
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        popup.style.display = 'none';
      }
    });

    updateCounters();
  </script>
</body>
</html>
